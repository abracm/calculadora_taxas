<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      Calculadora de Taxas de Competição
    </title>
    <style>
      body {
        margin-top:20;
        text-align: center;
        font-size: 20px;
        color: rgb(0, 0, 0);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
      }

      p {
        font-weight: bold;
        font-size: 25px;
      }

      .caixa {
        border: 1px gray;
      }

      img {
        max-height: 100px;
      }

      input[type=text] {
        min-height:50px;
        min-width: 10px;
        font-size: 20px;
      }

      table {
        border-collapse: collapse;
        border: 2px solid rgb(200,200,200);
        letter-spacing: 1px;
        font-size: 0.8rem;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
      }

      .center {
        margin-left: auto;
        margin-right: auto;
      }

      td, th {
        border: 1px solid rgb(190,190,190);
        padding: 10px 20px;
      }

      th {
        background-color: rgb(235,235,235);
      }

      td {
        text-align: center;
      }

      tr:nth-child(even) td {
        background-color: rgb(250,250,250);
      }

      tr:nth-child(odd) td {
        background-color: rgb(245,245,245);
      }

      caption {
        padding: 10px;
      }
      
    </style>
  </head>
  <body>
    <img src="https://i.imgur.com/WrFKnqk.png">
    <h1 style="font-size:5vw">Calculadora de Taxas de Competição</h1>

    <div class="form-wrapper">
      <input type="text" id="quantidadeCompetidores" name="quantidadeCompetidores" placeholder="Número de competidores">
      <input type="text" id="valorInscricao" name="" placeholder="Valor da inscrição">
      <p></p>
    </div>

    <label>
      <input type="checkbox" checked="true" onclick="htmlAluguel(this)" id="aluguel">
      Taxa de aluguel de equipamentos
    </label>

    <div class="caixa" name="associacoesEquipamentos" id="associacoesEquipamentos">
        <label>
          <input type="radio" name="choice-radio" checked="true" id="abracm">
          ABRACM
        </label>
        <label>
          <input type="radio" name="choice-radio" id="abcm">
          ABCM
        </label>
        <br>
        <label for="diasCompeticoes">Número de dias de competição:
          <select name="diasCompeticoes" id="diasCompeticoes">
            <option value="1">1</option>
            <option value="2" selected>2</option>
            <option value="3">3</option>
            <option value="4">4</option>
          </select>
        </label>
    </div>
    <br>
    <label>
      <input type="checkbox" id="stripe">
      <label for="stripe">Stripe para pagamento das inscrições</label> 
    </label>

    <p></p>

    <button onClick="calcularTaxa()">Calcular taxa</button>

    <p id="valorTaxa"></p>  

    <script>

      function calcularWCA(valorInscricao) {
        if ((valorInscricao * 0.15) > 2.32) {
          var valorWCA = valorInscricao * 0.15
        } else {
          var valorWCA = 2.32
        }
        return valorWCA
      }

      function calcularAluguel() {
        if (document.getElementById("abracm").checked) {
            var associacao = "ABRACM"
            var valorAssociacao = "2"
          }
          if (document.getElementById("abcm").checked) {
            var associacao = "ABCM"
            var valorAssociacao = "1"
          }
        var diasCompeticao = document.getElementById("diasCompeticoes").value
        return [valorAssociacao * diasCompeticao, associacao]
      }

      function calcularStripe(valorInscricao) {
        return (valorInscricao * 0.0399) + 0.39
      }

      function adicionaRow(nomeRow, valorCompetidor, numeroCompetidores) {
        return `
        <tr>
          <td>${nomeRow}</td>
          <td>R$${arredondaDinheiro(valorCompetidor)}</td>
          <td>R$${arredondaDinheiro(valorCompetidor * numeroCompetidores)}</td>
        </tr>
        `
      }

      function arredondaDinheiro(dinheiro) {
        return Math.round(dinheiro * 100) / 100
      }

      function calcularTaxa() {
        var numeroCompetidores = document.getElementById("quantidadeCompetidores").value
        var valorInscricao = document.getElementById("valorInscricao").value
        
        tabela = `<table class="center">
          <tr>
            <th>Taxa</th>
            <th>Por Competidor</th>
            <th>Total</th>
          </tr>`
        
        var valorWCA = calcularWCA(valorInscricao)
        tabela += adicionaRow("WCA", valorWCA, numeroCompetidores)
        var totalCompetidor = valorWCA

        if (document.getElementById("aluguel").checked) {
          var valorAluguelCompetidor = calcularAluguel()[0]
          var associacao = calcularAluguel()[1]
          tabela += adicionaRow(associacao, valorAluguelCompetidor, numeroCompetidores)
          totalCompetidor += valorAluguelCompetidor
        }
        
        if (document.getElementById("stripe").checked) {
          var valorStripe = calcularStripe(valorInscricao)
          tabela += adicionaRow("Stripe", valorStripe, numeroCompetidores)
          totalCompetidor += valorStripe
        }

        tabela+= `<tr>
            <th>Total</th>
            <th>R$${arredondaDinheiro(totalCompetidor)}</th>
            <th>R$${arredondaDinheiro(totalCompetidor * numeroCompetidores)}</th>
          </tr>`
        
        document.getElementById("valorTaxa").innerHTML = (tabela + "</table>")
      }

      function htmlAluguel(opcaoAluguel) {
        if(opcaoAluguel.checked == true) {
          document.getElementById("associacoesEquipamentos").innerHTML = `
          <label>
        <input type="radio" name="choice-radio" checked="true">
        ABRACM
      </label>
      <label>
        <input type="radio" name="choice-radio">
        ABCM
      </label>
      <br>
      <label for="diasCompeticoes">Número de dias de competição:
        <select name="diasCompeticoes" id="diasCompeticoes">
          <option value="1">1</option>
          <option value="2" selected>2</option>
          <option value="3">3</option>
          <option value="4">4</option>
        </select>
      </label>
          `
        } 
        if (opcaoAluguel.checked == false) {
          document.getElementById("associacoesEquipamentos").innerHTML = ``
        }
      } 
    </script>

  </body>
